(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d68314c"],{4734:function(t,e,i){"use strict";i("5f58")},"5f58":function(t,e,i){},9183:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-wrap"},[e("div",{staticClass:"title"},[t._v("视频截图拼接小工具")]),e("div",{staticClass:"container"},[e("el-form",{ref:"form",attrs:{"label-width":"80px"}},[e("el-form-item",{attrs:{label:"上传视频"}},[e("el-upload",{ref:"upload",attrs:{accept:".mp4, .avi, .mov",action:"",limit:1,"on-exceed":t.onUploadExceed,"on-change":t.onUploadChange,"auto-upload":!1,"on-remove":t.handleRemove}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传.mp4, .avi, .mov文件")])],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",disabled:!t.currentVideoUrl},on:{click:t.onPreview}},[t._v("预览")])],1)],1)],1),e("el-dialog",{attrs:{title:"截取图片",visible:t.centerDialogVisible,"close-on-click-modal":!1,"before-close":t.closeDialog,width:"50%"},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[e("div",{staticClass:"box"},[e("video",{ref:"currentVideo",attrs:{muted:"true",autoplay:"",controls:"",src:t.currentVideoUrl,width:"100%"},domProps:{muted:!0}}),e("div",{staticClass:"line",style:"bottom:"+t.lineHeight+"px"})]),e("el-button",{attrs:{type:"primary"},on:{click:t.getImgBase64}},[t._v("截取视频当前画面")]),t.imageList?e("div",{staticClass:"img-list"},[t._l(t.imageList,(function(i,a){return[e("el-popover",{key:a,attrs:{placement:"top-start",width:"300",trigger:"hover"}},[e("div",[e("el-image",{staticStyle:{width:"300px"},attrs:{src:t.imageList[a],fit:"cover"}}),e("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.onDelete(a)}}})],1),e("el-image",{staticStyle:{width:"100px"},attrs:{slot:"reference",src:t.imageList[a],fit:"cover"},slot:"reference"})],1)]}))],2):t._e(),e("div",{staticClass:"block"},[e("span",{staticClass:"demonstration"},[t._v("截图高度")]),e("el-slider",{attrs:{step:1,min:1,max:t.videoHeight},model:{value:t.heigth,callback:function(e){t.heigth=e},expression:"heigth"}})],1),e("div",{staticClass:"block"},[e("el-switch",{attrs:{"active-text":"首图剪裁","inactive-text":"首图不剪裁"},model:{value:t.special,callback:function(e){t.special=e},expression:"special"}})],1),e("el-button",{attrs:{type:"primary",disabled:0==t.imageList.length},on:{click:t.onStitch}},[t._v("拼接图片")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",disabled:!t.stitchImg},on:{click:t.downImg}},[t._v("下载拼接图片")])],1)],1)],1)},o=[],s=(i("7f7f"),i("28a5"),{data:function(){return{formData:{},centerDialogVisible:!1,currentVideoUrl:null,startTime:"",endTime:"",imageList:[],imageList1:[],videoWidth:"",videoHeight:0,heigth:0,videoReallHeight:0,lineHeight:0,stitchImg:"",special:!1}},watch:{heigth:function(t,e){this.lineHeight=t/this.videoHeight*this.videoReallHeight}},methods:{downImg:function(){var t=document.createElement("a");t.download="stitch",t.style.display="none",t.setAttribute("download","stitch"),t.href=this.stitchImg,document.body.appendChild(t),t.click(),document.body.removeChild(t)},onDelete:function(t){this.imageList.splice(t,1)},onStitch:function(){var t=this;this.mergeImgs(this.imageList).then((function(e){t.stitchImg=e}))},mergeImgs:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.videoWidth,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.heigth;return new Promise((function(o,s){var n=document.createElement("canvas");n.width=i,n.height=e.special?a*t.length:e.videoHeight+a*(t.length-1);var l=n.getContext("2d");t.map((function(i,a){var s=new Image;s.src=i,s.crossOrigin="Anonymous",s.onload=function(){e.special||0!=a?l.drawImage(s,0,e.videoHeight-e.heigth,e.videoWidth,e.heigth,0,e.special?e.heigth*a:e.videoHeight+e.heigth*(a-1),e.videoWidth,e.heigth):l.drawImage(s,0,0,e.videoWidth,e.videoHeight),a===t.length-1&&o(n.toDataURL("image/png"))}}))}))},getImgBase64:function(){var t=this.$refs.currentVideo,e=document.createElement("canvas");e.width=this.videoWidth,e.height=this.videoHeight;var i=e.getContext("2d");i.drawImage(t,0,0);var a=e.toDataURL("image/jpeg");this.imageList.push(a)},onPreview:function(){var t=this;this.centerDialogVisible=!0,setTimeout((function(){var e=t.$refs.currentVideo;t.videoWidth=e.videoWidth,t.videoHeight=e.videoHeight,t.heigth=200,t.videoReallHeight=e.clientHeight}),500)},closeDialog:function(){this.centerDialogVisible=!1,this.imageList=[],this.videoWidth="",this.videoHeight=0,this.heigth=0,this.videoReallHeight=0,this.lineHeight=0,this.stitchImg="",this.special=!1},onUploadChange:function(t,e){var i=t.name.split(".");i[i.length-1];this.currentVideoUrl=URL.createObjectURL(t.raw),this.formData=null,this.formData=new FormData,this.formData.append("fileSize",t.size),this.formData.append("firmwareFile",t.raw)},onUploadExceed:function(t,e,i){e[0].name=t[0].name,e[0].raw=t[0],this.onUploadChange(e[0])},handleRemove:function(){this.currentVideoUrl=null}}}),n=s,l=(i("4734"),i("2877")),r=Object(l["a"])(n,a,o,!1,null,null,null);e["default"]=r.exports}}]);